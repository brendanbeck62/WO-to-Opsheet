# Workorder to Opsheet
Generates a set of op sheets from a bom xlsx generated by solidworks, sorted by the first operation for operators to be able to sort operations by material.

Opens a dialog box where the bom xlsx file can be selected, and then saves a pdfto user's downloads, named after the bom file.

Ex.
```
bom file: 9929-06-100_A.xlsx
output pdf: 9929-06-100_A-opsheet.pdf
```

## Tagging
1. Commit change `"version x.x.x"`
1. `git tag vx.x.x`
1. `git push --tags`

## Packaging
Packaged using [pyinstaller](https://pyinstaller.org/en/stable/index.html), ends up in `dist/create_opsheet`.

Windows: simply navigate to the root of this project and run
```
run.bat
```

### Generating metadata
It also uses [pyinstaller-versionfile](https://pypi.org/project/pyinstaller-versionfile/)
 to generate a version file that can then be passed into the pyinstaller cli command with the `--version-file` param.

[metadata.yml](metadata.yml) contains the default info, and the block in the python file overwrites any defaults.


## excel file requirements (modifcations)
1. Add Level 0 with a quantity (logically maps the ID to the BOM)
1. Column headers must match exactly the example excel file
    TODO: Add example excel file
1. parent must be `Make` if any children are `Make`
1. Kit that doesn't have material ID cant be one of the 4 op1s (`Saw`, `Laser`, `Waterjet`, `Sub-Water`)

## Changelog

### 1.3.0
April 10, 2024

Adds logic for Level 0 quantity affecting all root parts.

### 1.2.0
Mar 10, 2024
 - [#1](https://github.com/brendanbeck62/WO-to-Opsheet/issues/1) - Fix parent quantity
 - Add back material table for laser and water jets, fix logic for calculating square feet

### 1.1.0
Feb 2, 2024
 - Add material table for saw
 - Convert inches to feet
 - Add 'WaterJet', now 4 op codes
 - Add metadata generation using pyinstaller-versionfile

### 1.0.0
January 14, 2024
First try.